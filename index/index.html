<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XMusic</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
    <div class="video-background-container" id="videoBackgroundContainer">
        <video id="backgroundVideo" loop></video>
    </div>

    <div class="app-container">
        <aside class="sidebar">
            <div class="logo" id="xmusicLogo">XMusic</div>
            <div class="logo" id="xcreatorLogo" style="display: none;">XCreator</div>
            <nav class="main-nav" id="xmusicNav">
                <a href="#" id="navHome" class="nav-link active"><span>Главная</span></a>
                <a href="#" id="navCategories" class="nav-link"><span>Категории</span></a>
                <a href="#" id="navFavorites" class="nav-link"><span>Избранное</span></a>
            </nav>
            <nav class="auth-nav">
                <a href="#" id="navProfile" class="nav-link" style="display: none;"><span>Профиль</span></a>
                <a href="#" id="navLogin" class="nav-link"><span>Войти</span></a>
                <a href="#" id="navRegister" class="nav-link"><span>Зарегистрироваться</span></a>
                <a href="#" id="navLogout" class="nav-link" style="display: none;"><span>Выйти</span></a>
            </nav>
            <div class="creator-studio-link" id="navCreatorStudio" style="display: none;">
                <a href="#" class="nav-link"><span>Студия Креатора</span></a>
            </div>
            <div class="admin-panel-link" id="navAdminPanel" style="display: none;">
                <a href="#" class="nav-link"><span>Панель Администратора</span></a>
            </div>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <div class="search-bar-wrapper">
                    <input type="text" id="searchInput" placeholder="Поиск музыки, артистов...">
                </div>
                <div class="ui-opacity-setting">
                    <label for="uiOpacity">Прозрачность интерфейса</label>
                    <input type="range" id="uiOpacity" min="0" max="1" step="0.1" value="0.5">
                </div>
            </header>
            
            <section id="homeView" class="view">
                <h2>Главная</h2>
                <div id="popularCategoriesGrid" class="grid-container"></div>
                <h3>Для вас</h3>
                <div id="forYouGrid" class="grid-container"></div>
                <h3>Возможно вам понравится</h3>
                <div id="maybeYouLikeGrid" class="grid-container"></div>
                <h3>Любимые подборки</h3>
                <div id="favoriteCollections" class="grid-container"></div>
            </section>
            
            <section id="allMediaView" class="view" style="display: none;">
                <h2>Все медиа</h2>
                <div class="filter-controls">
                    <select id="genreFilter"></select>
                    <select id="categoryFilter"></select>
                </div>
                <div id="allGridContainer" class="grid-container"></div>
                <div id="paginationControls">
                    <button id="prevPageBtn" class="page-btn" style="display: none;">Назад</button>
                    <span id="pageInfo"></span>
                    <button id="nextPageBtn" class="page-btn" style="display: none;">Вперед</button>
                </div>
            </section>
            
            <section id="favoritesView" class="view" style="display: none;">
                <h2>Избранное</h2>
                <div id="favoritesGridContainer" class="grid-container"></div>
            </section>

            <section id="loginView" class="view" style="display: none;">
                <h2>Вход</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginUsername">Имя пользователя</label>
                        <input type="text" id="loginUsername" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Пароль</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="submit-btn">Войти</button>
                </form>
            </section>

            <section id="registerView" class="view" style="display: none;">
                <h2>Регистрация</h2>
                <form id="registerForm">
                    <div class="form-group">
                        <label for="registerUsername">Имя пользователя</label>
                        <input type="text" id="registerUsername" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Пароль</label>
                        <input type="password" id="registerPassword" required>
                    </div>
                    <div class="g-recaptcha" data-sitekey="ВАШ_SITE_KEY"></div>
                    <button type="submit" class="submit-btn">Зарегистрироваться</button>
                </form>
            </section>

            <section id="creatorStudioView" class="view" style="display: none;">
                <h2>Студия Креатора</h2>
                <div class="creator-nav">
                    <button id="navMyTracksBtn">Мои треки</button>
                    <button id="navUploadBtn">Загрузить трек</button>
                    <button id="navCreatorStatsBtn">Статистика</button>
                    <button id="navMyCategoriesBtn">Мои Категории</button>
                </div>
                <div id="creatorContent">
                    <div id="myTracksView" style="display: none;">
                        <h3>Мои треки</h3>
                        <div id="myTracksGrid" class="grid-container"></div>
                    </div>
                    <div id="uploadView" style="display: none;">
                        <h3>Загрузить трек</h3>
                        <form id="uploadForm" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="trackTitle">Название трека</label>
                                <input type="text" id="trackTitle" required>
                            </div>
                            <div class="form-group">
                                <label for="trackArtist">Артист (если есть)</label>
                                <input type="text" id="trackArtist">
                            </div>
                            <div class="form-group">
                                <label for="trackFile">Аудио/Видео файл</label>
                                <input type="file" id="trackFile" required>
                            </div>
                            <div class="form-group">
                                <label for="trackCover">Обложка</label>
                                <input type="file" id="trackCover" required>
                            </div>
                            <div class="form-group">
                                <label for="trackType">Тип</label>
                                <select id="trackType" required>
                                    <option value="audio">Аудио</option>
                                    <option value="video">Видео</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="trackGenre">Жанр</label>
                                <select id="trackGenre" required></select>
                            </div>
                            <div class="form-group">
                                <label for="trackCategory">Категория (по желанию)</label>
                                <select id="trackCategory"></select>
                            </div>
                            <button type="submit" class="submit-btn">Загрузить</button>
                        </form>
                    </div>
                    <div id="creatorStatsView" style="display: none;">
                        <h3>Статистика</h3>
                        <div class="stats-card">
                            <h4>Общее количество прослушиваний</h4>
                            <p id="totalPlays"></p>
                        </div>
                        <div class="stats-card">
                            <h4>Прослушивания по дням</h4>
                            <canvas id="dailyPlaysChart"></canvas>
                        </div>
                        <div class="stats-card">
                            <h4>Популярные треки</h4>
                            <canvas id="trackStatsChart"></canvas>
                        </div>
                    </div>
                    <div id="myCategoriesView" style="display: none;">
                        <h3>Мои Категории</h3>
                        <div id="myCategoriesGrid" class="grid-container"></div>
                    </div>
                </div>
            </section>
            
            <section id="adminPanelView" class="view" style="display: none;">
                <h2>Панель Администратора</h2>
                <div class="admin-nav">
                    <button id="navAdminStatsBtn">Статистика</button>
                    <button id="navModerationBtn">Модерация</button>
                    <button id="navManageUsersBtn">Управление пользователями</button>
                    <button id="navManageCategoriesBtn">Управление категориями</button>
                </div>
                <div id="adminContent">
                    <div id="adminStatsView" style="display: none;">
                        <h3>Общая статистика</h3>
                        <div class="stats-card"><h4>Общее количество пользователей</h4><p id="adminTotalUsers"></p></div>
                        <div class="stats-card"><h4>Общее количество треков</h4><p id="adminTotalTracks"></p></div>
                        <div class="stats-card"><h4>Общее количество прослушиваний</h4><p id="adminTotalPlays"></p></div>
                    </div>
                    <div id="moderationView" style="display: none;">
                        <h3>Заявки на модерацию</h3>
                        <div id="moderationGrid" class="grid-container"></div>
                    </div>
                    <div id="manageUsersView" style="display: none;">
                        <h3>Заявки на Креаторов</h3>
                        <div id="creatorApplicationsGrid" class="grid-container"></div>
                        <h3>Все пользователи</h3>
                        <div id="usersGrid" class="grid-container"></div>
                    </div>
                    <div id="manageCategoriesView" style="display: none;">
                        <h3>Управление категориями</h3>
                        <button id="createCategoryBtn" class="submit-btn">Создать новую категорию</button>
                        <div id="categoriesGrid" class="grid-container"></div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <div class="media-player" id="mediaPlayer">
        <div class="track-info">
            <img id="playerCover" alt="Обложка">
            <div class="details">
                <span id="playerTitle"></span>
                <span id="playerArtist"></span>
            </div>
            <div class="player-controls">
                <button id="prevBtn" title="Предыдущий"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'><path d='M6 6h2v12H6zm3.5 6l8.5 6V6z'/></svg>" alt="Предыдущий"></button>
                <button id="playBtn" title="Воспроизвести"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'><path d='M8 5v14l11-7z'/></svg>" alt="Воспроизвести"></button>
                <button id="nextBtn" title="Следующий"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'><path d='M16 18h2V6h-2zm-8.5 6l8.5-6V6z'/></svg>" alt="Следующий"></button>
            </div>
            <div class="volume-controls">
                <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'><path d='M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.81 5 3.54 5 6.71s-2.11 5.9-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z'/></svg>" alt="Громкость">
                <input type="range" id="volumeBar" min="0" max="1" step="0.01" value="0.5">
            </div>
        </div>
        <div class="progress-bar-container">
            <div class="progress-bar"></div>
            <span class="current-time">0:00</span>
            <span class="total-time">0:00</span>
        </div>
    </div>
    
    <div id="videoModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeVideoModalBtn" title="Закрыть">&times;</button>
            <video id="videoPlayerModal" controls></video>
        </div>
    </div>

    <div id="creatorApplicationModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeCreatorApplicationModalBtn" title="Закрыть">&times;</button>
            <h2>Стать Креатором</h2>
            <form id="creatorApplicationForm">
                <div class="form-group">
                    <label for="fullName">Полное имя</label>
                    <input type="text" id="fullName" name="fullName" required>
                </div>
                <div class="form-group">
                    <label for="phoneNumber">Номер телефона</label>
                    <input type="tel" id="phoneNumber" name="phoneNumber" required>
                </div>
                <div class="form-group">
                    <label for="email">Почта</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="g-recaptcha" data-sitekey="ВАШ_SITE_KEY"></div>
                <button type="submit" class="submit-btn">Подать заявку</button>
            </form>
        </div>
    </div>

    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeCategoryModalBtn" title="Закрыть">&times;</button>
            <h2>Создать категорию</h2>
            <form id="categoryForm">
                <input type="hidden" id="categoryId" name="categoryId">
                <div class="form-group">
                    <label for="categoryName">Название категории</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group user-input-wrapper">
                    <label for="userSearchInput">Пользователи, которые могут публиковать</label>
                    <div class="user-input-container">
                        <input type="text" id="userSearchInput" placeholder="Введите имя пользователя..." autocomplete="off">
                        <span id="userSearchStatus"></span>
                    </div>
                </div>
                <div id="selectedUsersContainer"></div>
                <button type="submit" class="submit-btn">Сохранить</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>