<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spherify</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="background-sphere"></div>

    <div class="app-container">
        <aside class="sidebar">
            <div class="logo-container">
                <div class="logo" id="xmusicLogo">Spherify</div>
                <div class="logo" id="xcreatorLogo" style="display: none;">Spherify Studio</div>
            </div>
            <nav class="main-nav" id="xmusicNav">
                <a href="#" id="navHome" class="nav-link active"><i class="fas fa-home"></i><span>Главная</span></a>
                <a href="#" id="navCategories" class="nav-link"><i class="fas fa-tags"></i><span>Категории</span></a>
                <a href="#" id="navFavorites" class="nav-link" style="display: none;"><i class="fas fa-heart"></i><span>Избранное</span></a>
            </nav>
            <nav class="main-nav" id="xcreatorNav" style="display: none;">
                <a class="go-back-btn" id="backToXMusicBtn"><i class="fas fa-arrow-left"></i><span>Назад в Spherify</span></a>
                <a class="creator-nav-btn active" id="creatorHomeBtn" style="display: none;"><i class="fas fa-star"></i><span>Главная</span></a>
                <a class="creator-nav-btn" id="myTracksBtn" style="display: none;"><i class="fas fa-music"></i><span>Мои треки</span></a>
                <a class="creator-nav-btn" id="analyticsBtn" style="display: none;"><i class="fas fa-chart-line"></i><span>Аналитика</span></a>
                <a class="creator-nav-btn admin-section" id="adminApplicationsBtn" style="display: none;"><i class="fas fa-file-alt"></i><span>Заявки</span></a>
                <a class="creator-nav-btn admin-section" id="adminUsersBtn" style="display: none;"><i class="fas fa-users-cog"></i><span>Пользователи</span></a>
                <a class="creator-nav-btn admin-section" id="adminModerationBtn" style="display: none;"><i class="fas fa-check-double"></i><span>Модерация</span></a>
                <a class="creator-nav-btn admin-section" id="adminStatsBtn" style="display: none;"><i class="fas fa-chart-bar"></i><span>Статистика</span></a>
                <a class="creator-nav-btn admin-section" id="adminCategoriesBtn" style="fas fa-folder-plus"></i><span>Категории</span></a>
            </nav>
            <div class="sidebar-footer">
                <a class="nav-link" id="settingsBtn"><i class="fas fa-cog"></i><span>Настройки</span></a>
                <a class="nav-link" id="creatorStudioBtn" style="display: none;"><i class="fas fa-tools"></i><span>Creator Studio</span></a>
            </div>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <h1 id="viewTitle">Главная</h1>
                <div class="header-controls">
                    <div class="search-bar-wrapper">
                        <input type="text" id="searchInput" placeholder="Поиск по медиа...">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <div class="user-control-container">
                        <button class="login-btn" id="loginBtn"><span>Войти</span></button>
                        <span id="welcomeMessage" class="welcome-message" style="display: none;"></span>
                        <button class="logout-btn" id="logoutBtn" style="display: none;"><span>Выйти</span></button>
                    </div>
                </div>
            </header>

            <div id="homeView" class="view active-view">
                <section class="section xrecomen-section" id="xrecomenSection">
                    <p id="nowPlayingText" class="now-playing-text"></p>
                    <button id="xrecomenBtn">
                        <div class="xrecomen-title">Spherify Recommends</div>
                        <div class="xrecomen-subtitle">Возможно, вам понравится</div>
                    </button>
                </section>
                <section class="section">
                    <h2 class="section-title">Лучшее</h2>
                    <div class="scroll-container" id="allGridContainer"></div>
                </section>
                <section class="section" id="youLikeSection" style="display: none;">
                    <h2 class="section-title">Плейлисты для вас</h2>
                    <div class="scroll-container" id="youLikeGrid"></div>
                </section>
                <section class="section" id="favoriteCollectionsSection" style="display: none;">
                    <h2 class="section-title">Ваши любимые подборки</h2>
                    <div class="scroll-container" id="favoriteCollectionsGrid"></div>
                </section>
            </div>
            
            <div id="categoriesView" class="view">
                <section class="section">
                    <h2 class="section-title">Категории</h2>
                    <div class="grid-container" id="allCategoriesGrid">
                        <div class="category-card" data-category-id="all">
                            <h3>Все треки</h3>
                        </div>
                    </div>
                </section>
                <section class="section" style="display: none">
                    <h2 class="section-title">Кастомные категории</h2>
                    <div class="grid-container" id="customCategoriesGrid"></div>
                </section>
            </div>
            
            <div id="specificCategoryView" class="view">
                <button class="go-back-btn back-to-categories-btn" id="backToCategoriesBtn"><span><i class="fas fa-arrow-left"></i> К категориям</span></button>
                <h2 class="section-title" id="specificCategoryTitle">Название категории</h2>
                <div class="grid-container" id="specificCategoryGrid"></div>
            </div>

            <div id="favoritesView" class="view">
                <div class="grid-container" id="favoritesGridContainer"></div>
            </div>

            <div id="creatorView" class="view">
                <div id="creatorHomeSection" class="creator-main-section">
                    <div class="creator-main-screen">
                        <h2>Добро пожаловать в Spherify Studio</h2>
                        <p>Публикуйте свои произведения и следите за статистикой. Заявки обрабатываются вручную, дождитесь ответа.</p>
                        <button class="apply-btn" id="applyBtn">Подать заявку</button>
                    </div>
                </div>
                <div id="myTracksSection" class="creator-main-section" style="display: none;">
                    <div class="creator-section-header">
                        <h2 class="section-title">Мои треки</h2>
                        <button class="submit-btn" id="uploadTrackBtn">Загрузить трек</button>
                    </div>
                    <div id="myTracksGrid" class="grid-container"></div>
                </div>
                <div id="analyticsSection" class="creator-main-section" style="display: none;">
                    <h2 class="section-title">Ваша статистика</h2>
                    <div class="analytics-container">
                        <div class="analytics-block">
                            <h3 class="stat-label">Общее количество прослушиваний</h3>
                            <p class="stat-value" id="totalPlays">0</p>
                        </div>
                        <div class="analytics-block full-width">
                            <h3 class="stat-label">Прослушивания за последние 7 дней</h3>
                            <div class="chart-container">
                                <canvas id="analyticsChart"></canvas>
                            </div>
                        </div>
                        <div class="analytics-block">
                            <h3 class="stat-label">Топ-5 популярных треков</h3>
                            <table class="analytics-table">
                                <thead>
                                    <tr>
                                        <th>Трек</th>
                                        <th>Прослушивания</th>
                                    </tr>
                                </thead>
                                <tbody id="analyticsTrackTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="adminApplicationsSection" class="creator-main-section" style="display: none;">
                    <h2 class="section-title">Заявки в Creator</h2>
                    <div id="applicationsList"></div>
                </div>
                <div id="adminUsersSection" class="creator-main-section" style="display: none;">
                    <h2 class="section-title">Аккаунты</h2>
                    <div id="usersList"></div>
                </div>
                <div id="adminModerationSection" class="creator-main-section" style="display: none;">
                    <h2 class="section-title">Треки на модерации</h2>
                    <div id="moderationTracksList" class="grid-container"></div>
                </div>
                <div id="adminStatsSection" class="creator-main-section" style="display: none;">
                    <h2 class="section-title">Статистика</h2>
                    <div id="statsContent"></div>
                </div>
                <div id="adminCategoriesSection" class="creator-main-section" style="display: none;">
                    <div class="creator-section-header">
                        <h2 class="section-title">Категории</h2>
                        <button class="submit-btn create-category-btn" id="createCategoryBtn">Создать категорию</button>
                    </div>
                    <div class="categories-list-container" id="adminCategoriesList"></div>
                </div>
            </div>
        </main>
    </div>

    <div class="player">
        <div class="player-header">
            <div class="track-info">
                <img src="default.svg" alt="Track Art" id="playerCover">
                <div>
                    <span class="title" id="playerTitle">Выберите медиа</span>
                    <span class="artist" id="playerArtist"></span>
                </div>
            </div>
        </div>
        
        <div class="control-buttons-and-progress">
            <div class="control-buttons">
                <button id="repeatBtn" class="control-btn repeat-btn" title="Повтор"><i class="fas fa-redo"></i></button>
                <button id="prevBtn" class="control-btn" title="Назад"><i class="fas fa-step-backward"></i></button>
                <button class="play-button" id="playPauseBtn" title="Воспроизвести"><i id="playIcon" class="fas fa-play"></i><i id="pauseIcon" class="fas fa-pause" style="display: none;"></i></button>
                <button id="nextBtn" class="control-btn" title="Вперед"><i class="fas fa-step-forward"></i></button>
                <button id="favoritePlayerBtn" class="control-btn" title="Добавить в избранное"><i class="far fa-heart"></i></button>
            </div>
            
            <div class="progress-bar">
                <span id="currentTime">0:00</span>
                <div class="progress-bar-container">
                    <div class="progress-track"></div>
                    <div class="progress-filled"></div>
                    <div class="progress-thumb"></div>
                </div>
                <span id="duration">0:00</span>
            </div>
        </div>
        
        <div class="volume-controls">
            <i class="fas fa-volume-down volume-icon"></i>
            <input type="range" id="volumeBar" class="slider" min="0" max="1" step="0.01" value="1">
            <i class="fas fa-volume-up volume-icon"></i>
        </div>
    </div>
    
    <div id="videoModal" class="video-modal" style="display: none;">
        <div class="video-modal-content">
            <button class="close-btn" id="closeVideoBtn"><i class="fas fa-times"></i></button>
            <video id="videoPlayerModal" controls></video>
        </div>
    </div>
    
    <div id="moderationModal" class="moderation-modal" style="display: none;">
        <div class="modal-content">
            <button class="close-btn" id="closeModerationBtn"><i class="fas fa-times"></i></button>
            <h2>Проверка трека</h2>
            <div class="moderation-info">
                <img id="moderationPlayerCover" src="default.svg" alt="Обложка">
                <h3 id="moderationTitle">Название</h3>
                <p id="moderationArtist">Исполнитель:</p>
            </div>
            <audio id="moderationPlayer" controls></audio>
            <video id="moderationVideoPlayer" controls></video>
            <div class="moderation-actions">
                <button class="approve-track-btn" id="moderationApproveBtn">Одобрить</button>
                <button class="reject-track-btn" id="moderationRejectBtn">Отклонить</button>
            </div>
        </div>
    </div>

    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" title="Закрыть"><i class="fas fa-times"></i></button>
            <h2>Загрузить медиа</h2>
            <p class="modal-subtitle">Ваш трек будет отправлен на модерацию.</p>
            <form id="uploadForm">
                <div class="upload-form-left">
                    <div class="upload-type-selector">
                        <label><input type="radio" name="uploadType" value="audio" checked><span><i class="fas fa-music"></i> Аудио</span></label>
                        <label><input type="radio" name="uploadType" value="video"><span><i class="fas fa-video"></i> Видео</span></label>
                    </div>
                    <div class="form-group"><label for="trackTitle">Название</label><input type="text" id="trackTitle" name="title" required></div>
                    <div class="form-group"><label for="coverFile">Файл обложки (обязательно)</label><input type="file" id="coverFile" name="coverFile" accept="image/*" required></div>
                    
                    <div class="form-group">
                        <label for="categorySelect">Категория</label>
                        <select id="categorySelect" name="categoryId"></select>
                    </div>

                    <div class="form-group">
                        <label><input type="checkbox" id="isForeignArtist"> Сторонний исполнитель</label>
                        <div id="artistFields" style="display: none;">
                            <label for="foreignArtistName">Имя исполнителя</label>
                            <input type="text" id="foreignArtistName" name="artist">
                        </div>
                    </div>

                    <div id="audioFields" class="form-fields-group">
                        <div class="form-group"><label for="audioFile">Аудиофайл</label><input type="file" id="audioFile" name="audioFile" accept="audio/*" required></div>
                    </div>
                    <div id="videoFields" class="form-fields-group" style="display: none;">
                        <div class="form-group"><label for="videoFile">Видеофайл</label><input type="file" id="videoFile" name="videoFile" accept="video/*"></div>
                    </div>
                </div>
                <div class="upload-form-right">
                    <div id="uploadManager">
                        <h3>Статус загрузки</h3>
                        <p id="uploadStatusText">Ожидание...</p>
                        <div class="upload-status-bar">
                            <div class="upload-progress-fill" style="width: 0;"></div>
                        </div>
                        <p id="fileStatusText">Файл не выбран</p>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn" id="uploadSubmitBtn">Отправить на модерацию</button>
            </form>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" title="Закрыть"><i class="fas fa-times"></i></button>
            <h2>Настройки</h2>
            <div class="form-group">
                <label for="opacitySlider">Непрозрачность интерфейса</label>
                <div class="slider-wrapper">
                    <input type="range" id="opacitySlider" min="0.1" max="1" step="0.05">
                    <span id="opacityValue">50%</span>
                </div>
            </div>
            <div class="form-group">
                <label for="blurToggle">Размытие фона</label>
                <label class="switch">
                    <input type="checkbox" id="blurToggle" checked>
                    <span class="slider round"></span>
                </label>
            </div>
            <button class="logout-btn" id="logoutBtn" style="display: none;"><span><i class="fas fa-sign-out-alt"></i> Выйти</span></button>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" title="Закрыть"><i class="fas fa-times"></i></button>
            <h2>Вход</h2>
            <form id="loginForm">
                <div class="form-group"><label for="loginUsername">Логин</label><input type="text" id="loginUsername" required></div>
                <div class="form-group"><label for="loginPassword">Пароль</label><input type="password" id="loginPassword" required></div>
                <button type="submit" class="submit-btn">Войти</button>
                <button type="button" class="link-btn" id="switchToRegister">Нет аккаунта? Зарегистрироваться</button>
            </form>
        </div>
    </div>

    <div id="registerModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" title="Закрыть"><i class="fas fa-times"></i></button>
            <h2>Регистрация</h2>
            <form id="registerForm">
                <div class="form-group"><label for="registerUsername">Логин</label><input type="text" id="registerUsername" required></div>
                <div class="form-group"><label for="registerPassword">Пароль</label><input type="password" id="registerPassword" required></div>
                <button type="submit" class="submit-btn">Зарегистрироваться</button>
                <button type="button" class="link-btn" id="switchToLogin">Уже есть аккаунт? Войти</button>
            </form>
        </div>
    </div>

    <div id="applicationModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" title="Закрыть"><i class="fas fa-times"></i></button>
            <h2>Подать заявку в Creator Studio</h2>
            <form id="applicationForm">
                <div class="form-group"><label for="fullName">Имя и Фамилия</label><input type="text" id="fullName" name="fullName" required></div>
                <div class="form-group"><label for="phoneNumber">Номер телефона</label><input type="tel" id="phoneNumber" name="phoneNumber" pattern="\+7[0-9]{10}" placeholder="+79998887766" required></div>
                <div class="form-group"><label for="email">Почта</label><input type="email" id="email" name="email" required></div>
                <button type="submit" class="submit-btn">Подать заявку</button>
            </form>
        </div>
    </div>

    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeCategoryModalBtn" title="Закрыть"><i class="fas fa-times"></i></button>
            <h2>Создать категорию</h2>
            <form id="categoryForm">
                <input type="hidden" id="categoryId" name="categoryId">
                <div class="form-group">
                    <label for="categoryName">Название категории</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group user-input-wrapper">
                    <label for="userSearchInput">Пользователи, которые могут публиковать</label>
                    <div class="user-input-container">
                        <input type="text" id="userSearchInput" placeholder="Введите имя пользователя..." autocomplete="off">
                        <span id="userSearchStatus"></span>
                    </div>
                </div>
                <div id="selectedUsersContainer"></div>
                <button type="submit" class="submit-btn">Сохранить</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>